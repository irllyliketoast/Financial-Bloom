<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta settings and font imports -->
    <meta charset="utf-8">
    <title>Financial Bloom - Settings</title>
    
    <!-- External CSS -->
    <link rel="stylesheet" href="../styles/settings.css">
  
    <!-- Preconnecting to Google Fonts for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
    <!-- Fonts used: Silkscreen for UI, Play for paragraph text -->
    <link href="https://fonts.googleapis.com/css2?family=Silkscreen&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Afacad+Flux:wght@100..1000&family=Liter&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <!-- Icons for nav bar -->
    <link rel ="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=door_back,flyover,home,other_houses,settings,share,subscriptions,wallet" rel="stylesheet" />
  </head>

<body>
      <nav>
        <ul>
          <li><a href="../index.html"><span class="material-symbols-outlined">home</span>&nbsp;Dashboard</a></li>
          <li><a href="../budget/index.html"><span class="material-symbols-outlined">wallet</span>&nbsp;Budget</a></li>       
          <li><span class="material-symbols-outlined">share</span>&nbsp;Share</li>         
          <li id="current"><a href="index.html"><span class="material-symbols-outlined">settings</span>&nbsp;Settings</a></li>       
          <li><span class="material-symbols-outlined">door_back</span>&nbsp;Exit</li>
        </ul>
      </nav>
      <main>
        <h1>Profile</h1>
        <div class="profile-container">
            <div class="profile">
                <form id="profileForm">
                    <p>
                        <label for = "firstName">First Name:</label> 
                        <input type="text" name="firstName" id="profileFirstName">
                    </p>
                    <p>
                        <label for = "lastName">Last Name:</label> 
                        <input type="text" name="lastName" id="profileLastName">
                    </p>
                    <p>
                        <label for = "address">Address:</label> 
                        <input type="text" name="address" id="profileAddress">
                    </p>
                    <p>
                        <label for = "email">Email Address:</label>
                        <input type="email" name="email" id="profileEmail">
                    </p>
                    <p>
                        <label for = "phoneNumber">Phone Number:</label>
                        <input type="text" name="phoneNumber" id="profilePhone">
                    </p>
                    <input type="submit" value="Submit">
                </form>
            </div>
        </div>
        <h1>Financial Information</h1>
        <div class="finances-container">
            <div class="finances">
                <form id="financeForm">
                    <p>
                        <label for = "income">Estimated Income:</label>
                        <input type="text" name="income" id="financeIncome">
                    </p>
                    <p>
                        <label for = "debts">Estimated Debts:</label>
                        <input type="text" name="debts" id="financeDebts">
                    </p>
                    <input type="submit" value="Submit">
                </form>
            </div>
        </div>
        <h1>Budget</h1>
        <div class="budget-container">
            <div class="budget">
                <form id="budgetForm">
                    <p>
                        <label for = "groceries">Groceries:</label>
                        <input type = "text" name = "groceries" id="budgetGroceries" placeholder="Experts Suggest 15%">
                    </p>
                    <p>
                        <label for = "car">Car:</label>
                        <input type = "text" name = "car" id="budgetCar" placeholder="Experts Suggest 10%">
                    </p>
                    <p>
                        <label for = "home">Home:</label>
                        <input type = "text" name = "home" id="budgetHome" placeholder="Experts Suggest 28%">
                    </p>
                    <p>
                        <label for = "debts">Debts:</label>
                        <input type = "text" name = "debts" id="budgetDebts" placeholder="Experts Suggest 10%">
                    </p>
                    <p>
                        <label for = "savings">Savings:</label>
                        <input type = "text" name = "savings" id="budgetSavings" placeholder="Experts Suggest 10%">
                    </p>
                    <p>
                        <label for = "fun">Fun Money:</label>
                        <input type = "text" name = "fun" id="budgetFun" placeholder="No more than 27%">
                    </p>
                    <p>
                        <label for = "emFund">Emergency Fund:</label>
                        <input type = "text" name = "emFund" id="budgetEmFund" placeholder="3-6 Months of Bills">
                    </p>
                    <input type="submit" value="Submit">
                </form>
            </div>
        </div>
        <footer>Financial Bloom &trade; 2025</footer>
      </main>
      
      <aside>
        <h1>How to Budget?</h1>
        <p>
            &nbsp;&nbsp;A common rule of thumb in budgeting is called the 50/20/30 rule. What this means is that when budgeting it is suggested to spend: 50% of your income for your needs, 20% for your savings, and 30% for leisure/luxury.
        </p>
        <p>
            &nbsp;&nbsp;In the budget section to the left groceries, car, and home are considered needs. The 20% of your income for savings is split between debts and savings. This form evenly splits the two, however this is not a rule, you should use your best judgement to maximize your savings contributions.
        </p>
        <p>
            &nbsp;&nbsp;Finally about 30% of your income may go to luxury/leisure spending. This category includes anything not considered a need, this includes but is not limited to: eating out, travel, fun activites (such as going to the movies), and even healthy expenses such as a gym membership.      
        </p>
        <p>
        &nbsp;&nbsp;The last category is your emergency fund. It is extremely important to keep between 3-6 months of your expenses in an emergency fund. A savings account should not be withdrawn from unless it is a planned purchase not included in your monthly needs. This type of expense is generally reserved for down payments (or even better cash purchases). If you are no longer bringing in income, you should not be using your savings to pay your bills. Your emergency fund is the cushion between your monthly expenses and your savings account. 
        </p>
      </aside>

      <script>
        // Sanitization functions
        function sanitizeText(input) {
          return input.replace(/[<>"'`]/g, '');
        }

        function sanitizeName(name) {
          return name.replace(/[^a-zA-Z\s\-']/g, '');
        }

        function sanitizeEmail(email) {
          return email.replace(/[^a-zA-Z0-9@._-]/g, '');
        }

        function sanitizePhone(phone) {
          return phone.replace(/[^0-9\-() ]/g, '');
        }

        function sanitizeFinancial(input) {
          return input.replace(/[^0-9.]/g, '');
        }

        function isValidEmail(email) {
          return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        // Form submission handlers
        document.getElementById('profileForm').addEventListener('submit', function(e) {
          e.preventDefault();
          
          // Sanitize inputs
          document.getElementById('profileFirstName').value = sanitizeName(document.getElementById('profileFirstName').value);
          document.getElementById('profileLastName').value = sanitizeName(document.getElementById('profileLastName').value);
          document.getElementById('profileAddress').value = sanitizeText(document.getElementById('profileAddress').value);
          document.getElementById('profileEmail').value = sanitizeEmail(document.getElementById('profileEmail').value);
          document.getElementById('profilePhone').value = sanitizePhone(document.getElementById('profilePhone').value);
          
          if (!isValidEmail(document.getElementById('profileEmail').value)) {
            alert('Please enter a valid email address');
            return;
          }
          
          alert('Profile updated successfully!');
        });

        document.getElementById('financeForm').addEventListener('submit', function(e) {
          e.preventDefault();
          
          // Sanitize financial inputs
          document.getElementById('financeIncome').value = sanitizeFinancial(document.getElementById('financeIncome').value);
          document.getElementById('financeDebts').value = sanitizeFinancial(document.getElementById('financeDebts').value);
          
          alert('Financial information updated successfully!');
        });

        document.getElementById('budgetForm').addEventListener('submit', function(e) {
          e.preventDefault();
          
          // Sanitize all budget inputs
          const budgetFields = ['groceries', 'car', 'home', 'debts', 'savings', 'fun', 'emFund'];
          budgetFields.forEach(field => {
            document.getElementById('budget' + field.charAt(0).toUpperCase() + field.slice(1)).value = 
              sanitizeFinancial(document.getElementById('budget' + field.charAt(0).toUpperCase() + field.slice(1)).value);
          });
          
          alert('Budget settings updated successfully!');
        });
      </script>
  </body>
</html>
